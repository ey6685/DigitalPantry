extends admin_template

//- Replaces 'block content' inside layout_template with whatever Renders parameter 'title'

block content
	br
	br
	br
	br
	div(class='container-fluid', class='rounded', style='width: 90%')
		h1.dp-title-text #{title}
		br
		a.btn.btn-default(href='/ingredients/cards')
			i.dp-title-text.fa.fa-th-large.fa-2x
		a.btn.btn-default(href='/ingredients/showall')
			i.dp-title-text.fa.fa-list.fa-2x
		a.btn.btn-primary.dp-btn-secondary(href='/ingredients/add', class='h-75')
			| Add Multiple Ingredients
		p
		#accordion
			.card
				#headingTwo.card-header
					h5.mb-0
					button.btn.btn-primary.dp-btn-primary.collapsed(data-toggle='collapse', data-target='#collapseTwo', aria-expanded='false', aria-controls='collapseTwo')
						| Add ingredient
				#collapseTwo.collapse(aria-labelledby='headingTwo', data-parent='#accordion')
					.card-body
						form(method= 'POST', action= '/ingredients/add', class= 'form', enctype="multipart/form-data")
							.form-row(class='rounded')
								.col-sm-1.mt-3
									img#output(width='40', height='40')
								.form-group.col-md-2.mt-3
									label.btn.btn-primary.dp-btn-secondary.btn.btn-file Choose Image
										input(name='image', accept='image/*' ,type='file', style='display: none;', onchange='loadFile(event)')

								//- .form-group.col-md-4
								//- 	img#output.mr-2.ml-2.mt-2(width='40', height='40')
								//- 	input(type='file', id='image', name='image', accept='image/*', onchange='loadFile(event)', class='align-middle')
								.form-group.col-md-2
									input.form-control.mt-3(name='ingredientProperties[0]', type='text', placeholder='Name = Tuna')
								.form-group.col-md-1
									input.form-control.mt-3(name='ingredientProperties[1]', type='text', placeholder='Total = 2')
								.form-group.col-md-1
									.dropdown-inline
									select.form-control.mt-3(name='ingredientProperties[2]', required)
										option(value='') Measurement
										option(value='tsp.') Teaspoon
										option(value='tbsp.') Tablespoon
										option(value='fl oz') Fluid Ounce
										option(value='cup') Cup
										option(value='quart') Quart
										option(value='ml') Millilitre
										option(value='lb') Pound
										option(value='oz') Dry Ounce
								.form-group.col-md-2
									input.form-control.mt-3(name='ingredientProperties[3]', type='date')
								.form-group.col-md-1
									.dropdown-inline
									select.form-control.mt-3(name='ingredientProperties[4]', required)
										option(value='') Priority Item?
										option(value='High') Yes
										option(value='Low') No
								.col-md-1
									input.btn.btn-primary.dp-btn-primary.mt-3(type='submit', value='Add', class='form-group')
		table.table.dp-table(class='rounded')
			//-caption Available Ingredients
			thead
				tr
					th(scope='col') 
					th(scope='col') Name
					th(scope='col') Total
					th(scope='col') Measurement
					th(scope='col') Expiration Date
					th(scope='col') Item Priority
					th(scope='col') Action
			tbody
				for item in results
					tr
						td
							img.ml-3(src=item.ingredient_image_path, alt='image', width='50', height='50')
						td(class='align-middle')= item.ingredient_name
						td(class='align-middle')= item.ingredient_amount
						td(class='align-middle')= item.ingredient_unit_of_measurement
						td(class='align-middle')= item.ingredient_expiration_date
						td(class='align-middle')= item.priority
						td(class='align-middle') 
							//- Set a button with data-id that will be used for AJAX trigger defines in /js/main.js
							a.btn.btn-outline-danger.delete-ingredient.mr-0(data-id=item.ingredient_id,data-ex=item.ingredient_expiration_date, data-unit=item.ingredient_unit_of_measurement, data-qty=item.ingredient_amount) DELETE
		script.
			var loadFile = function(event) {
				var output = document.getElementById('output');
				output.src = URL.createObjectURL(event.target.files[0]);
				output.classList.add("img-thumbnail");
				document.getElementById("output").style.display = 'block';
				document.getElementById("output").style.width = '40px';
				document.getElementById("output").style.height = '40px';
				}
			//- $(document).on('change', ':file', function() {
			//- 	var input = $(this),
			//- 		numFiles = input.get(0).files ? input.get(0).files.length : 1,
			//- 		label = input.val().replace(/\\/g, '/').replace(/.*\//, '');
			//- 	input.trigger('fileselect', [numFiles, label]);
			//- });
			//- $(document).ready( function() {
			//- 	$(':file').on('fileselect', function(event, numFiles, label) {
			//- 		console.log(numFiles);
			//- 		console.log(label);
			//- 	});
			//- });